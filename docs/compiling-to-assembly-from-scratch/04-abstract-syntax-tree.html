<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=750;" />
  <!-- favicon stuff -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=1">
  <!--link rel="mask-icon" href="/safari-pinned-tab.svg?v=1"> <!-- color="#5bbad5">-->
  <link rel="shortcut icon" href="/favicon.ico?v=1">
  <!--meta name="theme-color" content="#ffffff"-->

  <title>4. Abstract Syntax Tree • Compiling to Assembly from Scratch</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { font-weight: bold; } /* Alert */
    code span.an { font-style: italic; } /* Annotation */
    code span.cf { font-weight: bold; } /* ControlFlow */
    code span.co { font-style: italic; } /* Comment */
    code span.cv { font-style: italic; } /* CommentVar */
    code span.do { font-style: italic; } /* Documentation */
    code span.dt { text-decoration: underline; } /* DataType */
    code span.er { font-weight: bold; } /* Error */
    code span.in { font-style: italic; } /* Information */
    code span.kw { font-weight: bold; } /* Keyword */
    code span.pp { font-weight: bold; } /* Preprocessor */
    code span.wa { font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="/style.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <span id="home-menu"><a title="Home" href="/">☰</a></span>





<header id="title-block-header">
</header>
<h1>Compiling to Assembly<small><small><br/>from Scratch</small></small><br/></h1>
<center><p> — <a href='./#table-of-contents'>Table of Contents</a> — </p></center>
<span id="fold"> </span>
<h1><br/><small><small>Chapter 4</small></small> <br/>Abstract Syntax Tree<br/><br/></h1>
<p> </p>
<p>Abstract syntax tree, or AST, is the central concept in compilers.</p>
<p>AST is a data-structure. It’s a <em>tree</em> that models the <em>syntax</em> of a programming language. But it <em>abstracts</em> away from the mundane details of syntax, such as the exact placement of parenthesis or semicolons.</p>
<!-- TODO CJlambda suggested a high-level definition of syntax -->
<p>This tree consists of <em>nodes</em>, where each node is a data object that represents a syntactic construct in the language. A <code>Return</code> node could represent a <code class="sourceCode javascript"><span class="cf">return</span></code> statement, an <code>Add</code> node can represent a <code>+</code> operator, an identifier referring to a variable could use an <code>Id</code> node, and so on.</p>
<p>For example, the following line of code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> n <span class="op">*</span> <span class="fu">factorial</span>(n <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span></code></pre></div>
<p>Can have an AST like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Return</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Multiply</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)<span class="op">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;factorial&quot;</span><span class="op">,</span> [</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">new</span> <span class="fu">Subtract</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">1</span>))<span class="op">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ])))</span></code></pre></div>
<p>In the next figure you can see a graphical representation of the same tree.</p>
<figure>
<img src="figures/ast-example.svg" style="width:75.0%" alt="AST corresponding to n * factorial(n - 1)" /><figcaption aria-hidden="true">AST corresponding to <code><b>return </b></code><code>n * factorial(n - 1)</code></figcaption>
</figure>
<p>Why use an AST? When working with a language construct, an AST makes it convenient to operate on it: to query, construct, and modify.</p>
<!--
Say, you want to add a parameter `p` to a call, given some existing call `myCall`?
We can construct this new call, by quering `myCall` for its callee and arguments fields:

    new Call(myCall.callee, [new Id("p"), ...myCall.args])
-->
<p>We design an AST so that it is convenient for us, depending on what we do with it: what kinds of transformations we want to make, which things to query or change.</p>
<p>For example, an AST can include source location information for error reporting. Or it can include documentation comments if our compiler needs to deal with those. Or it can include all comments and some notion of whitespace, if we want to have style-preserving transformations, like automatic refactoring.</p>
<blockquote>
<p><strong>Well, actually…</strong></p>
<p>There are also <em>concrete syntax trees</em>, also called <em>parse trees</em>. They reflect the structure and hierarchy down to <em>each</em> input symbol. They usually have too many details that we don’t care about when writing a compiler. But they are a good match for style-preserving transformations.</p>
</blockquote>
<p>We will represent each kind of node in our AST as a separate class: <code>Return</code>, <code>Multiply</code>, <code>Id</code>, etc. However, at the type level, we want to be able to refer to “any AST node”. For that TypeScript gives us several tools:</p>
<ul>
<li>interfaces,</li>
<li>abstract classes,</li>
<li>union types.</li>
</ul>
<p>Either of these works. We will use an interface:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">interface</span> AST {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST)<span class="op">:</span> boolean<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Each type of AST node will be a class that implements the <code>AST</code> interface. It starts simple, with <code>equals</code> as the only method. We will add methods to this interface (and the classes) as needed.</p>
<p>The <code>equals</code> method is mostly useful for unit-testing. The implementation is quite mundane, so for the most part, we will omit it and replace its body with an ellipsis.</p>
<h2 id="number-node">Number node</h2>
<p>Our first node is <code>Number</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="bu">Number</span> <span class="kw">implements</span> AST {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">value</span><span class="op">:</span> number) {}</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here we used the TypeScript shortcut for quickly defining instance variables using <code class="sourceCode javascript"><span class="kw">public</span></code> for the constructor parameter. Remember that it is equivalent to the following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="bu">Number</span> <span class="kw">implements</span> AST {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">value</span><span class="op">:</span> number<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="dt">value</span><span class="op">:</span> number) {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>It saves us quite some typing, which will be useful because we need to define many types of AST nodes.</p>
<p>We called our AST node <code>Number</code> because the data type in JavaScript and TypeScript is called <code>number</code>. However, our compiler will handle only unsigned integers.</p>
<table style="width:46%;">
<caption>Examples of the <code>Number</code> node</caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>0</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">0</span>)</code></td>
</tr>
<tr class="even">
<td><code>42</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>)</code></td>
</tr>
</tbody>
</table>
<h2 id="identifier-node">Identifier node</h2>
<p>Identifiers, or <em>id</em>s for short, refer to variables in the code.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Id <span class="kw">implements</span> AST {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">value</span><span class="op">:</span> string) {}</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table style="width:49%;">
<caption>Examples of the <code>Id</code> node</caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)</code></td>
</tr>
<tr class="even">
<td><code>hello</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;hello&quot;</span>)</code></td>
</tr>
</tbody>
</table>
<h2 id="operator-nodes">Operator nodes</h2>
<p>The next AST node is <code>Not</code>, which stands for the logical negation operator (<code>!</code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Not <span class="kw">implements</span> AST {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">term</span><span class="op">:</span> AST) {}</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table style="width:58%;">
<caption>Examples of the <code>Not</code> node</caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>!x</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Not</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>))</code></td>
</tr>
<tr class="even">
<td><code>!42</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Not</span>(<span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>))</code></td>
</tr>
</tbody>
</table>
<p>Negation is the only <em>prefix operator</em> (or <em>unary operator</em>) that we define. However, we define several <em>infix operators</em> (or <em>binary operators</em>).</p>
<p>Equality operator (<code>==</code>) and its opposite (<code>!=</code>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Equal <span class="kw">implements</span> AST {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">left</span><span class="op">:</span> AST<span class="op">,</span> <span class="kw">public</span> <span class="dt">right</span><span class="op">:</span> AST) {}</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NotEqual <span class="kw">implements</span> AST {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">left</span><span class="op">:</span> AST<span class="op">,</span> <span class="kw">public</span> <span class="dt">right</span><span class="op">:</span> AST) {}</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<caption>Examples of <code>Equal</code> and <code>NotEqual</code> nodes</caption>
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x == y</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Equal</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)<span class="op">,</span> <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>))</code></td>
</tr>
<tr class="even">
<td><code>10 != 25</code></td>
<td style="text-align: right;"><code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">NotEqual</span>(<span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">10</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">25</span>))</code></td>
</tr>
</tbody>
</table>
<p>Addition (<code>+</code>), subtraction (<code>-</code>), multiplication (<code>*</code>), and division (<code>/</code>):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Add <span class="kw">implements</span> AST {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">left</span><span class="op">:</span> AST<span class="op">,</span> <span class="kw">public</span> <span class="dt">right</span><span class="op">:</span> AST) {}</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Subtract <span class="kw">implements</span> AST {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">left</span><span class="op">:</span> AST<span class="op">,</span> <span class="kw">public</span> <span class="dt">right</span><span class="op">:</span> AST) {}</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Multiply <span class="kw">implements</span> AST {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">left</span><span class="op">:</span> AST<span class="op">,</span> <span class="kw">public</span> <span class="dt">right</span><span class="op">:</span> AST) {}</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Divide <span class="kw">implements</span> AST {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">left</span><span class="op">:</span> AST<span class="op">,</span> <span class="kw">public</span> <span class="dt">right</span><span class="op">:</span> AST) {}</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<caption>Examples of <code>Add</code> and <code>Multiply</code> nodes</caption>
<colgroup>
<col style="width: 44%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x + y</code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>          <span class="kw">new</span> <span class="fu">Add</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)<span class="op">,</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>))</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><code>10 * 25</code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Multiply</span>(<span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">10</span>)<span class="op">,</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>               <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">25</span>))</span></code></pre></div></td>
</tr>
</tbody>
</table>
<p>Note that since the parameters are ASTs themselves, that means they can be arbitrarily nested.</p>
<p>For example, <code>42 + !(20 != 10)</code> will be:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Add</span>(<span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>)<span class="op">,</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> <span class="fu">Not</span>(<span class="kw">new</span> <span class="fu">NotEqual</span>(<span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">20</span>)<span class="op">,</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                             <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">10</span>))))</span></code></pre></div>
<p>Not all combinations of AST nodes make sense. Nonetheless, the one above happens to be valid in JavaScript.</p>
<h2 id="call-node">Call node</h2>
<p><code>Call</code> refers to a function name (or <em>callee</em>), and an array of arguments. For example, <code>f(x)</code> becomes: <code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;f&quot;</span><span class="op">,</span> [<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)])</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Call <span class="kw">implements</span> AST {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">callee</span><span class="op">:</span> string<span class="op">,</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">args</span><span class="op">:</span> <span class="bu">Array</span><span class="op">&lt;</span>AST<span class="op">&gt;</span>) {}</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> other <span class="kw">instanceof</span> Call <span class="op">&amp;&amp;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">callee</span> <span class="op">===</span> other<span class="op">.</span><span class="at">callee</span> <span class="op">&amp;&amp;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">args</span><span class="op">.</span><span class="at">length</span> <span class="op">===</span> other<span class="op">.</span><span class="at">args</span><span class="op">.</span><span class="at">length</span> <span class="op">&amp;&amp;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">args</span><span class="op">.</span><span class="fu">every</span>((arg<span class="op">,</span> i) <span class="kw">=&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        arg<span class="op">.</span><span class="fu">equals</span>(other<span class="op">.</span><span class="at">args</span>[i]))<span class="op">;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The language of our baseline compiler is restricted such that only named functions can be called.</p>
<p>We can’t name the arguments array <code>arguments</code>, since this clashes with JavaScript built-in <code>arguments</code> object. So, with some reluctance, let’s call it <code>args</code>.</p>
<p>The <code>Call</code> node is interesting because it has both a primitive string and an array of AST as its members. JavaScript doesn’t have an agreed-upon protocol for equality; that’s why <code>Call</code> makes an excellent example of how to implement the <code>equals</code> method in JavaScript:</p>
<ul>
<li>It uses <code class="sourceCode javascript"><span class="kw">instanceof</span></code> operator to check that the other AST is also a <code>Call</code>.</li>
<li>It compares the <code>callee</code> strings using the <code>===</code> operator.</li>
<li>It uses the <code>.equals</code> method for comparing AST nodes of each argument.</li>
<li>It compares array by length and checks <code>every</code> element.</li>
</ul>
<p>Languages other than JavaScript often have more elegant ways of dealing with structural equality.</p>
<table>
<caption>Examples of the <code>Call</code> node</caption>
<colgroup>
<col style="width: 39%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>f(x, y)</code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;f&quot;</span><span class="op">,</span> [</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)<span class="op">,</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>)<span class="op">,</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  ])</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><code>factorial(n - 1)</code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;factorial&quot;</span><span class="op">,</span> [</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Subtract</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)<span class="op">,</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">1</span>))<span class="op">,</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  ])</span></code></pre></div></td>
</tr>
</tbody>
</table>
<h2 id="return-node">Return node</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Return <span class="kw">implements</span> AST {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">term</span><span class="op">:</span> AST) {}</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<caption>Examples of the <code>Return</code> node</caption>
<colgroup>
<col style="width: 44%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code class="sourceCode javascript"><span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">0</span>))</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><code class="sourceCode javascript"><span class="cf">return</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Return</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Subtract</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)<span class="op">,</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>               <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">1</span>)))</span></code></pre></div></td>
</tr>
</tbody>
</table>
<h2 id="block-node">Block node</h2>
<p><code>Block</code> refers to a block of code delimited with curly braces.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Block <span class="kw">implements</span> AST {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">statements</span><span class="op">:</span> <span class="bu">Array</span><span class="op">&lt;</span>AST<span class="op">&gt;</span>) {}</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<caption>Examples of the <code>Block</code> node</caption>
<colgroup>
<col style="width: 41%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>{}</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Block</span>([])</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(x)<span class="op">;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Block</span>([</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;f&quot;</span><span class="op">,</span> [<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)])<span class="op">,</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>))<span class="op">,</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>])</span></code></pre></div></td>
</tr>
</tbody>
</table>
<h2 id="if-node">If node</h2>
<p>The <code>If</code> node has three branches:</p>
<ul>
<li><code>conditional</code> refers to the expression that is evaluated to either true or false,</li>
<li><code>consequence</code> is the branch taken in the true case, and</li>
<li><code>alternative</code> is the branch taken in the false case.</li>
</ul>
<!-- -->
<div class="sourceCode" id="cb28"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> If <span class="kw">implements</span> AST {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">conditional</span><span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">consequence</span><span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">alternative</span><span class="op">:</span> AST) {}</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This way, the following:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (x <span class="op">==</span> <span class="dv">42</span>) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Becomes:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">If</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Equal</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>)))<span class="op">,</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Block</span>([<span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>))])<span class="op">,</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Block</span>([<span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>))])<span class="op">,</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Curly braces are optional for if statements, thus, the following:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (x <span class="op">==</span> <span class="dv">42</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y<span class="op">;</span></span></code></pre></div>
<p>Becomes:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">If</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Equal</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>)))<span class="op">,</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>))<span class="op">,</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>))<span class="op">,</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>How do we represent an <code class="sourceCode javascript"><span class="cf">if</span></code> without the <code class="sourceCode javascript"><span class="cf">else</span></code> branch? We could have a separate node for it, or we can do a simple trick: representing <code class="sourceCode javascript"><span class="cf">if</span> (x) y</code> the same way as <code class="sourceCode javascript"><span class="cf">if</span> (x) y <span class="cf">else</span> {}</code>. In other words, by placing an empty <code>Block</code> as the <code>alternative</code>.</p>
<h2 id="function-definition-node">Function definition node</h2>
<p>A function definition consists of a function name, an array of parameters, and the function’s body.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="bu">Function</span> <span class="kw">implements</span> AST {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">name</span><span class="op">:</span> string<span class="op">,</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">parameters</span><span class="op">:</span> <span class="bu">Array</span><span class="op">&lt;</span>string<span class="op">&gt;,</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">body</span><span class="op">:</span> AST) {}</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<!-- TODO talk about global and module scope, export/import keyword gotcha -->
<p>Consider the following function definition.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f</span>(x<span class="op">,</span> y) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>When converted to an AST it becomes as follows.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="bu">Function</span>(<span class="st">&quot;f&quot;</span><span class="op">,</span> [<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="st">&quot;y&quot;</span>]<span class="op">,</span> <span class="kw">new</span> <span class="fu">Block</span>([</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;y&quot;</span>))<span class="op">,</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>]))</span></code></pre></div>
<p>Notice that in a function definition, the parameters are strings, while in a function call, they are ASTs. This fact reflects that function calls can have nested expressions, while function definitions simply list the inbound variable names.</p>
<h2 id="variable-declaration-node">Variable declaration node</h2>
<p><code>Var</code> nodes are for variable declarations. So <code class="sourceCode javascript"><span class="kw">var</span> x <span class="op">=</span> <span class="dv">42</span><span class="op">;</span></code> becomes <code class="sourceCode javascript"><span class="kw">new</span> <span class="fu">Var</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>))</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Var <span class="kw">implements</span> AST {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">name</span><span class="op">:</span> string<span class="op">,</span> <span class="kw">public</span> <span class="dt">value</span><span class="op">:</span> AST) {}</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<!-- Removed for page alignment

Table: Examples of the `Var` node

+-----------------------+------------------------------------------------------+
| Source                | AST                                                  |
+=======================+======================================================+
|                       | ```js                                                |
| `var x = 42;`{.js}    | new Var("x", new Number(42))                         |
|                       | ```                                                  |
+-----------------------+------------------------------------------------------+
|                       | ```js                                                |
| `var y = a + b;`{.js} | new Var("y", new Add(new Id("a"),                    |
|                       |                      new Id("b")))                   |
|                       | ```                                                  |
+-----------------------+------------------------------------------------------+
-->
<h2 id="assignment-node">Assignment node</h2>
<p>An assignment is represented with the node <code>Assign</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Assign <span class="kw">implements</span> AST {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">name</span><span class="op">:</span> string<span class="op">,</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">value</span><span class="op">:</span> AST) {}</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Assignment differs from variable declaration in the following way: assignment changes the value of an existing variable, and does not define a new one. At least, that’s the distinction that we will assume. JavaScript allows assignment of a variable that is not defined yet; in such case, it will create a global variable. TypeScript, on the other hand, dissallows this error-prone behavior.</p>
<table>
<caption>Examples of the <code>Assign</code> node</caption>
<colgroup>
<col style="width: 34%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code class="sourceCode javascript">x <span class="op">=</span> <span class="dv">42</span><span class="op">;</span></code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb38"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Assign</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">42</span>))</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><code class="sourceCode javascript">y <span class="op">=</span> a <span class="op">+</span> b<span class="op">;</span></code></td>
<td style="text-align: right;"><div class="sourceCode" id="cb39"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">Assign</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>           <span class="kw">new</span> <span class="fu">Add</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;a&quot;</span>)<span class="op">,</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;b&quot;</span>))))</span></code></pre></div></td>
</tr>
</tbody>
</table>
<h2 id="while-loop-node">While loop node</h2>
<p>The last node of our AST and the last construct in our baseline language is the while loop.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> While <span class="kw">implements</span> AST {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">conditional</span><span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>              <span class="kw">public</span> <span class="dt">body</span><span class="op">:</span> AST) {}</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">equals</span>(<span class="dt">other</span><span class="op">:</span> AST) {…}</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<caption>Examples of the <code>While</code> node</caption>
<colgroup>
<col style="width: 36%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">AST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><div class="sourceCode" id="cb41"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (x)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>()<span class="op">;</span></span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb42"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">While</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)<span class="op">,</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;f&quot;</span><span class="op">,</span> []))</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb43"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (x) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>()<span class="op">;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb44"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">While</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;x&quot;</span>)<span class="op">,</span> <span class="kw">new</span> <span class="fu">Block</span>([</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Call</span>(<span class="st">&quot;f&quot;</span><span class="op">,</span> [])<span class="op">,</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>]))</span></code></pre></div></td>
</tr>
</tbody>
</table>
<h2 id="summary">Summary</h2>
<p>Let’s look at a larger snippet converted to an AST. Remember our factorial function:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">factorial</span>(n) {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> result <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (n <span class="op">!=</span> <span class="dv">1</span>) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> result <span class="op">*</span> n<span class="op">;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is the corresponding AST:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="bu">Function</span>(<span class="st">&quot;factorial&quot;</span><span class="op">,</span> [<span class="st">&quot;n&quot;</span>]<span class="op">,</span> <span class="kw">new</span> <span class="fu">Block</span>([</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Var</span>(<span class="st">&quot;result&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">1</span>))<span class="op">,</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">While</span>(<span class="kw">new</span> <span class="fu">NotEqual</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)<span class="op">,</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                         <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">1</span>))<span class="op">,</span> <span class="kw">new</span> <span class="fu">Block</span>([</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Assign</span>(<span class="st">&quot;result&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="fu">Multiply</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;result&quot;</span>)<span class="op">,</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)))<span class="op">,</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="fu">Assign</span>(<span class="st">&quot;n&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="fu">Subtract</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;n&quot;</span>)<span class="op">,</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                               <span class="kw">new</span> <span class="bu">Number</span>(<span class="dv">1</span>)))<span class="op">,</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  ]))<span class="op">,</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">Return</span>(<span class="kw">new</span> <span class="fu">Id</span>(<span class="st">&quot;result&quot;</span>))<span class="op">,</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>]))</span></code></pre></div>
<p>We finish this chapter with a table that summarizes all the AST constructors that we’ve covered, their signatures, and examples of what source code these AST nodes can represent.</p>
<!--
Why did we choose to represent each node with its own class?
Why do we have to use classes, and not some data format such as JSON?
That's because we want to use the most powerful control-flow method available in the language to deal with ASTs.
-->
<table>
<caption>Summary of AST constructor signatures with examples</caption>
<colgroup>
<col style="width: 61%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="header">
<th>AST Constructor Signature</th>
<th style="text-align: right;">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><div class="sourceCode" id="cb47"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Number</span>(value<span class="op">:</span> number)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Id</span>(value<span class="op">:</span> string)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Not</span>(term<span class="op">:</span> AST)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Equal</span>(left<span class="op">:</span> AST<span class="op">,</span> right<span class="op">:</span> AST)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">NotEqual</span>(left<span class="op">:</span> AST<span class="op">,</span> right<span class="op">:</span> AST)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Add</span>(left<span class="op">:</span> AST<span class="op">,</span> right<span class="op">:</span> AST)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Subtract</span>(left<span class="op">:</span> AST<span class="op">,</span> right<span class="op">:</span> AST)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Multiply</span>(left<span class="op">:</span> AST<span class="op">,</span> right<span class="op">:</span> AST)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Divide</span>(left<span class="op">:</span> AST<span class="op">,</span> right<span class="op">:</span> AST)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb48"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="dv">42</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>term</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>left <span class="op">==</span> right</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>left <span class="op">!=</span> right</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>left <span class="op">+</span> right</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>left <span class="op">-</span> right</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>left <span class="op">*</span> right</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>left <span class="op">/</span> right</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb49"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Call</span>(callee<span class="op">:</span> string<span class="op">,</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>     args<span class="op">:</span> <span class="bu">Array</span><span class="op">&lt;</span>AST<span class="op">&gt;</span>)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb50"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">callee</span>(a1<span class="op">,</span> a2<span class="op">,</span> a3)</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb51"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Return</span>(term<span class="op">:</span> AST)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb52"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> term<span class="op">;</span></span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb53"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Block</span>(statements<span class="op">:</span> <span class="bu">Array</span><span class="op">&lt;</span>AST<span class="op">&gt;</span>)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb54"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>{ s1<span class="op">;</span> s2<span class="op">;</span> s3<span class="op">;</span> }</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb55"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">If</span>(conditional<span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>   consequence<span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>   alternative<span class="op">:</span> AST)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb56"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (conditional)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  consequence</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  alternative</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb57"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Function</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  name<span class="op">:</span> string<span class="op">,</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  parameters<span class="op">:</span> <span class="bu">Array</span><span class="op">&lt;</span>string<span class="op">&gt;,</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  body<span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb58"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">name</span>(p1) {</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  body<span class="op">;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb59"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Var</span>(name<span class="op">:</span> string<span class="op">,</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    value<span class="op">:</span> AST)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb60"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> name <span class="op">=</span> value<span class="op">;</span></span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb61"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Assignment</span>(name<span class="op">:</span> string<span class="op">,</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>           value<span class="op">:</span> AST)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb62"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>name <span class="op">=</span> value<span class="op">;</span></span></code></pre></div></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><div class="sourceCode" id="cb63"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">While</span>(conditional<span class="op">:</span> AST<span class="op">,</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>      body<span class="op">:</span> AST)</span></code></pre></div></td>
<td style="text-align: right;"><div class="sourceCode" id="cb64"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (conditional)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  body<span class="op">;</span></span></code></pre></div></td>
</tr>
</tbody>
</table>
<p>In the next two chapters, you will learn about converting a program from source to an AST, or in other words, about <em>parsing</em>.</p>
<center><a href="./05-parser-combinators#fold">Next: Chapter 5. Parser Combinators</a></center>


  <hr class="fleuron" />
</body>
</html>
